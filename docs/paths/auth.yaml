/auth/42/login:
  get:
    tags: [Auth]
    operationId: Auth_start42Login
    summary: Initiate 42 OAuth2 login
    security: []
    responses:
      '302':
        description: Redirect to 42 authorization page
        headers:
          Location:
            schema:
              type: string

/auth/42/callback:
  get:
    tags: [Auth]
    operationId: Auth_handle42Callback
    summary: 42 OAuth2 callback
    security: []
    parameters:
      - name: code
        in: query
        required: true
        schema:
          type: string
    responses:
      '302':
        description: Redirect to the frontend after creating a session
        headers:
          Location:
            schema:
              type: string
      '401':
        description: Invalid authorization code

/auth/status:
  get:
    tags: [Auth]
    operationId: Auth_getStatus
    summary: Get current authentication status
    responses:
      '200':
        description: Authenticated user
        content:
          application/json:
            schema:
              $ref: '../components/schemas/user.yaml#/User'
      '401':
        description: Not authenticated

/auth/logout:
  post:
    tags: [Auth]
    operationId: Auth_logout
    summary: Log out current user
    responses:
      '204':
        description: Logged out successfully

/auth/2fa/generate:
  post:
    tags: [TwoFA]
    operationId: Auth_generate2FA
    summary: Generate 2FA secret & QR code
    responses:
      '200':
        description: Generated 2FA secret
        content:
          application/json:
            schema:
              $ref: '../components/schemas/auth.yaml#/TwoFactorSecret'
      '401':
        description: Not authenticated

/auth/2fa/enable:
  post:
    tags: [TwoFA]
    operationId: Auth_enable2FA
    summary: Enable 2FA for current user
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas/auth.yaml#/Enable2FARequest'
    responses:
      '200':
        description: 2FA enabled successfully
      '400':
        description: Invalid TOTP code
      '401':
        description: Not authenticated
