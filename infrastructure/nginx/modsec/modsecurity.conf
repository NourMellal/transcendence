## Minimal ModSecurity configuration (stub)
# You will need a ModSecurity-enabled Nginx build to use these settings.
# Set SecRuleEngine to On/DetectionOnly/Off to control blocking behavior.



## Hardened ModSecurity configuration
## NOTE: This file is intended for production-like blocking. Test in a staging
## environment before enabling in production. Tuned settings follow best-practice
## defaults: body access enabled, reasonable limits, robust audit logging, and
## blocking enabled.

# Enable blocking (change to DetectionOnly for initial testing)
SecRuleEngine On

# Request/response body handling
SecRequestBodyAccess On
SecResponseBodyAccess Off
# Limits to guard memory usage (tune to your environment)
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 131072

# Audit log â€” capture relevant events and failures
SecAuditEngine RelevantOnly
SecAuditLog /var/log/modsec_audit.log
SecAuditLogParts ABIJDEFHZ

# Performance: don't inspect very large request headers
SecRequestBodyLimitAction Reject

# Recommended recommended hygiene
SecPcreMatchLimit 2000
SecPcreMatchLimitRecursion 2000

# Custom CRS configuration (disable IP reputation checks)
Include /etc/nginx/modsec/crs-setup-custom.conf

# Load OWASP CRS
Include /etc/nginx/modsec/crs/crs-setup.conf
Include /etc/nginx/modsec/crs/rules/*.conf
